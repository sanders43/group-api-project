<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
<h2>Heart Rate</h2>
<canvas id="hrChart" width ="200" height= "100"></canvas>

<script>
  const xdate = [];
  const yheartRate = []

makeChart();
    
async function makeChart(){
    await getHR()
    const ctx = document.getElementById('hrChart').getContext('2d');
  

    const myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: xdate,
        datasets: [{
            label: 'Heart Rate',
            data: yheartRate,
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgba(255, 99, 132, 1)',
                
            borderWidth: 1
             }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        suggestedMin: 50,
                        suggestedMax: 80
                    }
                }]
            }
        }
    });
}

async function getHR(){
        const response = await fetch('/api/posts');
        const data = await response.json();

        
        console.log(data);
        data.forEach(data => {
            const heartRate = data.heart_rate;
            console.log(heartRate);
            yheartRate.push(heartRate);

            const date = data.created_at;
            console.log(date);
            xdate.push(date);
        })
}
</script>